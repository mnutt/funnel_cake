<div class="section span-12">
	<h1><span><%=@start_state.to_s.titleize%></span> to <span><%=@end_state.to_s.titleize%></span></h1>
	<div class="section span-12">
		<%= render :partial => 'analytics/common/filter_fields_input', :style=>'font-size: 14px' %>
		<%= render :partial => 'analytics/common/daterange_label' %>
	</div>
</div>
<div class="section span-12">
	<div class="column span-4">
		<%= render 'conversion', :start_state=>@start_state, :end_state=>@end_state %>
	</div>
	<div class='column span-8 last' id='state_chart_container'>
		<%= render 'analytics/conversions/graph', :start_state=>@start_state, :end_state=>@end_state %>
		<%= render 'analytics/conversions/graph', :start_state=>@start_state, :end_state=>@end_state, :stat=>:rate %>
		<h3>Visitors in End State: <%=@end_state%></h3>
		<%= render 'analytics/states/visitors_table', :state=>@end_state, :stats=>[:name, :email, :recent_event_date], :category=>'id' %>
	</div>
</div>
<script type="text/javascript">
<%= render 'analytics/common/filter_fields_update.js' %>
<%= render 'analytics/common/visitors_update.js' %>

	var updateAnalyticsStats = function() {
		<%= render 'analytics/common/grab_filter_fields.js' %>

		updateVisitorInfo(opts);
		setPeriodLabel(period)
		FunnelCakeWidget.update(opts);
	};

	FunnelCakeWidget.draw();
	updateAnalyticsStats();
</script>
